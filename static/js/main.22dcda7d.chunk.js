(this.webpackJsonpmessenger=this.webpackJsonpmessenger||[]).push([[0],{131:function(e,t,n){e.exports=n(201)},136:function(e,t,n){},171:function(e,t){},174:function(e,t,n){},201:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),s=n.n(c);n(136),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(31),i=n(42),l=n(89),u=n(70),m=n(123),d=n.n(m),g={socket:null,createConnection:function(){this.socket=d()("https://sin-messenger.herokuapp.com/")},subscribe:function(e,t,n){var a,r,c;null===(a=this.socket)||void 0===a||a.on("init-messages-published",e),null===(r=this.socket)||void 0===r||r.on("new-message-sent",t),null===(c=this.socket)||void 0===c||c.on("user-typing",n)},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e,(function(e){console.log(e),e&&alert(e)}))},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e,(function(e){e&&alert(e)}))},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")}},f={messages:[],typingUsers:[]},h=function(e){return{type:"messages-received",messages:e}},b=function(e){return{type:"new-message-received",message:e}},v=function(e){return{type:"typingUserAdded",user:e}},p=function(e){return function(t){g.sendMessage(e)}},E=n(124),y=Object(i.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages-received":return Object(u.a)({},e,{messages:t.messages});case"new-message-received":return Object(u.a)({},e,{messages:[].concat(Object(l.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"typingUserAdded":return Object(u.a)({},e,{typingUsers:[].concat(Object(l.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});default:return e}}}),O=Object(i.d)(y,Object(i.a)(E.a));window.store=O;var j=n(35),k=n(10),N=(n(174),n(69)),_=n.n(N),w=n(67),C=n.n(w),T=n(65),x=n.n(T),B=n(125),F=n.n(B),P=function(e){var t=Object(o.c)((function(e){return e.chat.messages})),n=Object(o.c)((function(e){return e.chat.typingUsers})),c=Object(o.b)(),s=Object(a.useState)(""),i=Object(j.a)(s,2),l=i[0],u=i[1],m=Object(a.useState)(!0),d=Object(j.a)(m,2),f=d[0],h=d[1],b=Object(a.useState)(0),v=Object(j.a)(b,2),E=v[0],y=v[1];Object(a.useEffect)((function(){var e;f&&(null===(e=O.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t,n]),Object(a.useEffect)((function(){return function(){c((function(e){g.destroyConnection()}))}}),[]);var O=Object(a.useRef)(null),N=t.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(F.a,null),r.a.createElement("b",null,e.user.name,": "),e.message,r.a.createElement("hr",null))})),w=n.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("b",null,e.name,":")," ...")}));return"anonymous"===e.name?r.a.createElement(k.a,{to:"/login"}):r.a.createElement("div",null,r.a.createElement("div",{className:_.a.chatWindow,onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight;t.scrollTop>E&&Math.abs(n-t.scrollTop)<2?h(!0):h(!1),y(t.scrollTop)}},N,w,r.a.createElement("div",{ref:O})),r.a.createElement("div",{className:_.a.messageField},r.a.createElement(x.a,{id:"outlined-basic",label:"Enter your message...",value:l,onKeyPress:function(e){"Enter"===e.key&&(c(p(l)),u(""))},onChange:function(e){u(e.currentTarget.value),c((function(e){g.typeMessage()}))}})),r.a.createElement("div",{className:_.a.messageButton},r.a.createElement(C.a,{size:"medium",variant:"outlined",color:"primary",onClick:function(){c(p(l)),u("")}},"Send message")))},S=n(44),U=n.n(S),M=n(39),W=function(e){var t=Object(o.b)(),n=Object(k.g)(),c=function(){var n;e.setName(e.temporaryName),t((n=e.temporaryName,function(e){g.sendName(n)}))};return Object(a.useEffect)((function(){t((function(e){g.createConnection(),g.subscribe((function(t,n){e(h(t)),n("data from front")}),(function(t){e(b(t))}),(function(t){e(v(t))}))}))}),[]),r.a.createElement("div",null,r.a.createElement("h1",{className:U.a.header},"Welcome to chat"),r.a.createElement("div",{className:U.a.nameField},r.a.createElement(x.a,{id:"outlined-basic",label:"Enter your name",onChange:function(t){return e.setTemporaryName(t.currentTarget.value)},onKeyPress:function(t){"Enter"===t.key&&e.temporaryName.length>0&&(c(),n.push("/chat"))}})),r.a.createElement("div",{className:U.a.nameButton},r.a.createElement(M.b,{className:U.a.buttonText,to:e.temporaryName.length<1?"/login":"/chat"},r.a.createElement(C.a,{className:U.a.buttonText,size:"medium",variant:"outlined",color:"primary",disabled:e.temporaryName.length<1,onClick:c},"Enter to chat"))))},A=function(){var e=Object(a.useState)(""),t=Object(j.a)(e,2),n=t[0],c=t[1],s=Object(a.useState)("anonymous"),o=Object(j.a)(s,2),i=o[0],l=o[1];return r.a.createElement("div",{className:"App"},r.a.createElement(k.d,null,r.a.createElement(k.b,{exact:!0,path:"/",render:function(){return r.a.createElement(k.a,{to:"/login"})}}),r.a.createElement(k.b,{path:"/login",render:function(){return r.a.createElement(W,{temporaryName:n,setTemporaryName:c,name:i,setName:l})}}),r.a.createElement(k.b,{path:"/chat",render:function(){return r.a.createElement(P,{name:i})}})))};s.a.render(r.a.createElement(M.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:O},r.a.createElement(A,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e,t,n){e.exports={nameField:"LoginPage_nameField__3k50E",nameButton:"LoginPage_nameButton__PlP0X",buttonText:"LoginPage_buttonText__90rpc"}},69:function(e,t,n){e.exports={chatWindow:"Chat_chatWindow__1IOs5",messageField:"Chat_messageField__22XGF",messageButton:"Chat_messageButton__3Ym2P",header:"Chat_header__FZ4b1"}}},[[131,1,2]]]);
//# sourceMappingURL=main.22dcda7d.chunk.js.map