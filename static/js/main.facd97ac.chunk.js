(this.webpackJsonpmessenger=this.webpackJsonpmessenger||[]).push([[0],{131:function(e,t,n){e.exports=n(201)},136:function(e,t,n){},171:function(e,t){},174:function(e,t,n){},201:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(7),c=n.n(s);n(136),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var o=n(31),i=n(42),u=n(89),l=n(50),m=n(123),d=n.n(m),g={socket:null,createConnection:function(){this.socket=d()("https://sin-messenger.herokuapp.com/")},subscribe:function(e,t,n){var a,r,s;null===(a=this.socket)||void 0===a||a.on("init-messages-published",e),null===(r=this.socket)||void 0===r||r.on("new-message-sent",t),null===(s=this.socket)||void 0===s||s.on("user-typing",n)},destroyConnection:function(){var e;null===(e=this.socket)||void 0===e||e.disconnect(),this.socket=null},sendName:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-name-sent",e,(function(e){console.log(e),e&&alert(e)}))},sendMessage:function(e){var t;null===(t=this.socket)||void 0===t||t.emit("client-message-sent",e,(function(e){e&&alert(e)}))},typeMessage:function(){var e;null===(e=this.socket)||void 0===e||e.emit("client-typed")}},f={messages:[],typingUsers:[]},h=function(e){return{type:"messages-received",messages:e}},b=function(e){return{type:"new-message-received",message:e}},p=function(e){return{type:"typingUserAdded",user:e}},v=function(e){return{type:"typingUserDeleted",user:e}},y=0,E=function(e){return function(t){g.sendMessage(e)}},O=n(124),j=Object(i.c)({chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"messages-received":return Object(l.a)({},e,{messages:t.messages});case"new-message-received":return Object(l.a)({},e,{messages:[].concat(Object(u.a)(e.messages),[t.message]),typingUsers:e.typingUsers.filter((function(e){return e.id!==t.message.user.id}))});case"typingUserAdded":return Object(l.a)({},e,{typingUsers:[].concat(Object(u.a)(e.typingUsers.filter((function(e){return e.id!==t.user.id}))),[t.user])});case"typingUserDeleted":return Object(l.a)({},e,{typingUsers:e.typingUsers.filter((function(e){return e.id!==t.user.id}))});default:return e}}}),N=Object(i.d)(j,Object(i.a)(O.a));window.store=N;var k=n(35),_=n(10),w=(n(174),n(70)),T=n.n(w),C=n(68),U=n.n(C),x=n(66),B=n.n(x),M=n(125),S=n.n(M),F=function(e){var t=Object(o.c)((function(e){return e.chat.messages})),n=Object(o.c)((function(e){return e.chat.typingUsers})),s=Object(o.b)(),c=Object(a.useState)(""),i=Object(k.a)(c,2),u=i[0],l=i[1],m=Object(a.useState)(!0),d=Object(k.a)(m,2),f=d[0],h=d[1],b=Object(a.useState)(0),p=Object(k.a)(b,2),v=p[0],y=p[1];Object(a.useEffect)((function(){var e;f&&(null===(e=O.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}))}),[t,n]),Object(a.useEffect)((function(){return function(){s((function(e){g.destroyConnection()}))}}),[]);var O=Object(a.useRef)(null),j=t.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement(S.a,null),r.a.createElement("b",null,e.user.name,": "),e.message,r.a.createElement("hr",null))})),N=n.map((function(e){return r.a.createElement("div",{key:e.id},r.a.createElement("b",null,e.name,":")," ...")}));return"anonymous"===e.name?r.a.createElement(_.a,{to:"/login"}):r.a.createElement("div",null,r.a.createElement("div",{className:T.a.chatWindow,onScroll:function(e){var t=e.currentTarget,n=t.scrollHeight-t.clientHeight;t.scrollTop>v&&Math.abs(n-t.scrollTop)<2?h(!0):h(!1),y(t.scrollTop)}},j,N,r.a.createElement("div",{ref:O})),r.a.createElement("div",{className:T.a.messageField},r.a.createElement(B.a,{id:"outlined-basic",label:"Enter your message...",value:u,onKeyPress:function(e){"Enter"===e.key&&(s(E(u)),l(""))},onChange:function(e){l(e.currentTarget.value),s((function(e){g.typeMessage()}))}})),r.a.createElement("div",{className:T.a.messageButton},r.a.createElement(U.a,{size:"medium",variant:"outlined",color:"primary",onClick:function(){s(E(u)),l("")}},"Send message")))},W=n(44),P=n.n(W),z=n(39),A=function(e){var t=Object(o.b)(),n=Object(_.g)(),s=function(){var n;e.setName(e.temporaryName),t((n=e.temporaryName,function(e){g.sendName(n)}))};return Object(a.useEffect)((function(){t((function(e){g.createConnection(),g.subscribe((function(t,n){e(h(t)),n("data from front")}),(function(t){e(b(t))}),(function(t){e(p(t)),clearTimeout(y),y=window.setTimeout((function(){e(v(t))}),5e3)}))}))}),[]),r.a.createElement("div",null,r.a.createElement("h1",{className:P.a.header},"Welcome to chat"),r.a.createElement("div",{className:P.a.nameField},r.a.createElement(B.a,{id:"outlined-basic",label:"Enter your name",onChange:function(t){return e.setTemporaryName(t.currentTarget.value)},onKeyPress:function(t){"Enter"===t.key&&e.temporaryName.length>0&&(s(),n.push("/chat"))}})),r.a.createElement("div",{className:P.a.nameButton},r.a.createElement(z.b,{className:P.a.buttonText,to:e.temporaryName.length<1?"/login":"/chat"},r.a.createElement(U.a,{className:P.a.buttonText,size:"medium",variant:"outlined",color:"primary",disabled:e.temporaryName.length<1,onClick:s},"Enter to chat"))))},I=function(){var e=Object(a.useState)(""),t=Object(k.a)(e,2),n=t[0],s=t[1],c=Object(a.useState)("anonymous"),o=Object(k.a)(c,2),i=o[0],u=o[1];return r.a.createElement("div",{className:"App"},r.a.createElement(_.d,null,r.a.createElement(_.b,{exact:!0,path:"/",render:function(){return r.a.createElement(_.a,{to:"/login"})}}),r.a.createElement(_.b,{path:"/login",render:function(){return r.a.createElement(A,{temporaryName:n,setTemporaryName:s,name:i,setName:u})}}),r.a.createElement(_.b,{path:"/chat",render:function(){return r.a.createElement(F,{name:i})}})))};c.a.render(r.a.createElement(z.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(o.a,{store:N},r.a.createElement(I,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},44:function(e,t,n){e.exports={nameField:"LoginPage_nameField__2TzQ3",nameButton:"LoginPage_nameButton__1lNK0",buttonText:"LoginPage_buttonText__1FdEM"}},70:function(e,t,n){e.exports={chatWindow:"Chat_chatWindow__35nOg",messageField:"Chat_messageField__2XZhh",messageButton:"Chat_messageButton__14qt4",header:"Chat_header__eIfgM"}}},[[131,1,2]]]);
//# sourceMappingURL=main.facd97ac.chunk.js.map